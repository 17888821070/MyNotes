# 说一说进程、线程、协程

## 概念

* 进程

  > 系统资源分配的基本单位，是资源分配的基本单位
  >
  > 拥有独立的虚拟地址空间，以进程为单位对资源进行保护
  >
  > 持有堆，类信息，静态资源等信息

* 线程

  > 是操作系统调度的基本单位，是程序的一条执行路径
  >
  > 持有线程独有的信息，栈，计数器等
  >
  > 处理机真正运行的是线程

* 协程

  > 完全是由程序编写的，在用户态模拟时间片定时运行不同的协程
  >
  > 持有协程栈信息，协程计数器

## 切换

* 进程切换

  > 上下文切换：操作系统调度，保存当前进程信息到PCB，加载下一个进程的PCB。
  >
  > * PCB：进程控制块，用来存储进程的标识信息，线程信息和控制信息。

* 线程切换

  > 上下文切换：操作系统调度，保存当前线程信息到TCB，加载下一个线程的TCB
  >
  > * TCB：线程控制块，用来存储线程的标识信息

* 协程切换

  > 没有上下文切换，由程序进行时间片分配，由程序实现协程调度

## 联系

* 进程和线程

  > 1. 进程对线程是一对多的关系
  >
  > 2. 进程和线程切换都需要上下文切换，需要操作系统调度

* 线程和协程

  > 进程对协程是一对多的关系

## 区别

* 进程和线程

  > 1. 进程是系统资源分配的基本单位，线程是cpu调度的基本单位
  > 2. 进程持有独立的虚拟内存空间，线程共享所属进程的内存空间
  > 3. 进程切换开销大于线程切换，需要对进程地址空间和各线程执行状态进行保存和加载
  > 4. 进程崩溃不会影响到其他进程，线程崩溃可能会影响到同进程内的其他线程
  > 5. 进程通信麻烦，线程通信只需要使用共享变量即可

* 线程和协程

  > 协程切换不需要进行上下文切换，没有用户态和核心态的切换